---
title: Next.js Authentication Simplified with Clerk
description: Discover how to integrate Clerk with Next.js and streamline your user management. Elevate your authentication process with our step-by-step guide.
date: March 27, 2023
---

As a front-end developer diving into full-stack development, I've found that implementing authentication can be a challenging task. That's why I highly recommend Clerk - it's hands down the most user-friendly way to handle authentication. Clerk provides both user management UIs and APIs for React and Next.js, making it a breeze to integrate into your projects. In this blog post, I'll guide you through the process of adding authentication to your Next.js app using Clerk, so you can focus on building your app's features without worrying about authentication.

## Setting up a Next.js App

Creating a Next.js app with server components is now simpler than ever. You just need to take advantage of the new appDir feature. By adding the --experimental-app flag to your command, a new app directory will automatically be generated for you, with everything in it considered a server component by default.

To begin, just run any of the following commands:

```bash
npx create-next-app@latest --experimental-app
```

Once your Next.js app is created, it's a good idea to clean up any unnecessary code to keep your project organized and efficient.

## Setting up a Clerk

### Creating project

Creating a project on [Clerk.com](http://clerk.com/) is a simple process. Just head over to the website, sign in, and follow the prompts to get started.

### Install `@clerk/nextjs`

To get started with @clerk/nextjs, simply install it using your preferred package manager. In this example, I'll be using pnpm, but feel free to use whatever package manager works best for you.

```bash
pnpm add @clerk/nextjs
```

### Set environment keys

To use Clerk's SDK, you'll need to set two environment variables. Here's a simple example for your `.env.local` file. You can find your respective keys on the API Keys page of your Clerk dashboard. With these keys properly set, you'll be able to use Clerk's SDK in your Next.js app hassle-free.

```bash
NEXT_PUBLIC_CLERK_PUBLISHABLE_KEY=publishable_key(both of this will be unique)
CLERK_SECRET_KEY=secret_key
```

### Create a middleware file

A middleware file is a piece of code that acts as a mediator between two systems or components. It is a software layer that sits between the application and the server and helps to process, modify or manage incoming and outgoing requests. Middleware files are commonly used in frameworks such as Next.js, Express.js, and Django to handle authentication, logging, error handling, and other functionalities. They provide a way to streamline and organize code, making it easier to manage and maintain complex web applications.

To create your middleware file, simply add the following code snippet to a file named `middleware.js` or `middleware.ts`, located in the root directory of your project.

```tsx
import { withClerkMiddleware } from "@clerk/nextjs/server";
import { NextResponse } from "next/server";
import type { NextRequest } from "next/server";

export default withClerkMiddleware((req: NextRequest) => {
  //   console.log("Middleware running");
  return NextResponse.next();
});

// Stop Middleware running on static files
export const config = {
  matcher: "/((?!_next/image|_next/static|favicon.ico).*)",
};
```

### Updating Your Root Layout for `<ClerkProvider>`

Wrap your app with `<ClerkProvider`. This gives every component easy access to your authentication state, which is convenient for checking whether the user is signed in or not. Once you've wrapped your whole app with `<ClerkProvider>`, your `layout.tsx` file should look like the following example. Feel free to modify the basic styling I've provided to suit your preferences.

```tsx
import "./globals.css";
import { ClerkProvider } from "@clerk/nextjs/app-beta";

export const metadata = {
  title: "Create Next App",
  description: "Generated by create next app",
};

export default function RootLayout({
  children,
}: {
  children: React.ReactNode;
}) {
  return (
    <ClerkProvider>
      <html lang="en">
        <body className=" flex min-h-screen items-center justify-center bg-zinc-900 text-center text-neutral-100 antialiased">
          {children}
        </body>
      </html>
    </ClerkProvider>
  );
}
```

### Adding signing button

To add a sign-in button to your app, start by creating a new client component specifically for this feature. Create a separate folder for your components. In the newly created sign-in component, simply render the sign-in and sign-out buttons based on whether the user is logged in or not. This straightforward approach ensures that your sign-in process is easy to manage and customize as needed.

```tsx
"use client";

import { SignInButton, useUser, SignOutButton } from "@clerk/nextjs";

export default function SignIn() {
  const { isSignedIn, user } = useUser();

  return (
    <main>
      {!isSignedIn && <SignInButton mode="modal" />}
      {isSignedIn && (
        <>
          <p className="mb-2">Welcome, {user.username}!</p>
          <SignOutButton />
        </>
      )}
    </main>
  );
}
```

Congratulations! You have now successfully integrated authentication into your Next.js 13 app. To learn more about Clerk's capabilities and features, be sure to check out their official website at [clerk.com/docs](https://clerk.com/docs). Additionally, you can explore the [GitHub repository](https://github.com/SameerJadav/nextjs-clerk-auth) and [live website](https://nextjs-clerk-auth.vercel.app/) for more information on how authentication was implemented.
